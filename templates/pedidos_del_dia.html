<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>Reporte de Pedidos del Día</title>
            <style>
                @page { 
                    size: letter; 
                    margin: 1.5cm; 
                }
                body {
                    font-family: Arial, sans-serif;
                    font-size: 10pt;
                    line-height: 1.3;
                }
                .header {
                    text-align: center;
                    margin-bottom: 20px;
                    border-bottom: 2px solid #333;
                    padding-bottom: 10px;
                }
                .company-name {
                    font-size: 18pt;
                    font-weight: bold;
                    margin-bottom: 5px;
                }
                .report-title {
                    font-size: 14pt;
                    font-weight: bold;
                    margin-bottom: 5px;
                }
                .report-date {
                    font-size: 10pt;
                    color: #666;
                }
                .summary {
                    background: #f0f0f0;
                    padding: 10px;
                    margin-bottom: 15px;
                    border-radius: 5px;
                }
                .summary-row {
                    display: flex;
                    justify-content: space-between;
                    margin-bottom: 5px;
                }
                .pedido {
                    page-break-inside: avoid;
                    margin-bottom: 20px;
                    border: 1px solid #ddd;
                    padding: 10px;
                    border-radius: 5px;
                }
                .pedido-header {
                    background: #5271ff;
                    color: white;
                    padding: 8px;
                    margin: -10px -10px 10px -10px;
                    border-radius: 5px 5px 0 0;
                }
                .pedido-info {
                    margin-bottom: 10px;
                }
                .info-row {
                    margin-bottom: 3px;
                }
                .label {
                    font-weight: bold;
                    display: inline-block;
                    width: 120px;
                }
                table {
                    width: 100%;
                    border-collapse: collapse;
                    margin: 10px 0;
                }
                th {
                    background: #f8f9fa;
                    border: 1px solid #ddd;
                    padding: 6px;
                    text-align: left;
                    font-size: 9pt;
                }
                td {
                    border: 1px solid #ddd;
                    padding: 5px;
                    font-size: 9pt;
                }
                .text-right {
                    text-align: right;
                }
                .total-row {
                    font-weight: bold;
                    background: #f8f9fa;
                }
                .footer {
                    margin-top: 30px;
                    text-align: center;
                    font-size: 8pt;
                    color: #666;
                    border-top: 1px solid #ddd;
                    padding-top: 10px;
                }
                @media print {
                    .no-print { display: none; }
                    body { margin: 0; }
                }
            </style>
        </head>
        <body>
            <div class="header">
                <div class="company-name">DISTRIBUIDORA SEBAOT</div>
                <div class="report-title">REPORTE DE PEDIDOS DEL DÍA</div>
                <div class="report-date">${fechaHoy}</div>
            </div>

            <div class="summary">
                <div class="summary-row">
                    <span><strong>Total de Pedidos:</strong></span>
                    <span>${cantidadPedidos}</span>
                </div>
                <div class="summary-row">
                    <span><strong>Total General:</strong></span>
                    <span>Q. ${totalGeneral.toFixed(2)}</span>
                </div>
            </div>

            ${pedidos.map(pedido => `
                <div class="pedido">
                    <div class="pedido-header">
                        <strong>PEDIDO No. ${pedido.NUMERO_PEDIDO}</strong> - ${pedido.ESTADO}
                    </div>
                    
                    <div class="pedido-info">
                        <div class="info-row">
                            <span class="label">Fecha:</span> ${pedido.FECHA}
                        </div>
                        <div class="info-row">
                            <span class="label">Cliente:</span> ${pedido.NOMBRE_CLIENTE}
                        </div>
                        <div class="info-row">
                            <span class="label">NIT:</span> ${pedido.NIT}
                        </div>
                        <div class="info-row">
                            <span class="label">Dirección:</span> ${pedido.DIRECCION}
                        </div>
                    </div>

                    <table>
                        <thead>
                            <tr>
                                <th style="width: 10%">Código</th>
                                <th style="width: 40%">Producto</th>
                                <th style="width: 15%">Unidad</th>
                                <th style="width: 10%" class="text-right">Cant.</th>
                                <th style="width: 12%" class="text-right">Precio</th>
                                <th style="width: 13%" class="text-right">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${pedido.DETALLE.map(item => `
                                <tr>
                                    <td>${item.CODIGO_PRODUCTO}</td>
                                    <td>${item.NOMBRE_PRODUCTO}</td>
                                    <td>${item.UNIDAD_MEDIDA}</td>
                                    <td class="text-right">${item.CANTIDAD}</td>
                                    <td class="text-right">Q. ${parseFloat(item.PRECIO_UNITARIO).toFixed(2)}</td>
                                    <td class="text-right">Q. ${parseFloat(item.TOTAL_LINEA).toFixed(2)}</td>
                                </tr>
                            `).join('')}
                            <tr class="total-row">
                                <td colspan="5" class="text-right">TOTAL DEL PEDIDO:</td>
                                <td class="text-right">Q. ${parseFloat(pedido.TOTAL_DOCUMENTO).toFixed(2)}</td>
                            </tr>
                        </tbody>
                    </table>

                    ${pedido.COMENTARIOS ? `
                        <div style="margin-top: 10px; padding: 8px; background: #fff3cd; border-radius: 3px;">
                            <strong>Comentarios:</strong> ${pedido.COMENTARIOS}
                        </div>
                    ` : ''}
                </div>
            `).join('')}

            <div class="footer">
                <div>Fecha y hora de impresión: ${new Date().toLocaleString('es-GT')}</div>
                <div>Este documento fue generado automáticamente</div>
            </div>

            <script>
                window.onload = function() {
                    window.print();
                    window.onafterprint = function() {
                        window.close();
                    };
                };
            </script>
        </body>
        </html>